<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>DrawIt Canvas</title>
	<link rel="stylesheet" href="/static/draw.css">
</head>


<body class="mode-drawing">

	<div class="ui-layer">
		<div id="colorTools" class="ui-element" title="Choose Color">
			<input type="color" id="colorPicker" value="#000000">
		</div>

		<div id="modeSwitch" class="ui-element" title="Toggle Mode">
			<img class="show-in-drawing" src="/static/Icons/Move%20icon.svg" alt="Switch to View">

			<img class="show-in-view" src="/static/Icons/Draw%20icon.svg" alt="Switch to Draw">
		</div>
	</div>


	<div id="viewport">
		<div id="canvas-container">
			<canvas id="Canva" width="1600" height="900"></canvas>
			<!-- <canvas id="map" width="1600" height="900"></canvas> -->
		</div>
	</div>


	<script type="module" src="/static/draw.js"></script>
	<script type="module">
		import {setupWebsocket} from "/static/websockets.js";
		import {DrawingModule} from '/static/draw.js';
  	import {Event, DrawingEventType} from "/static/events.js"
		import {Map} from "/static/map.js"
		const sendMessage = await setupWebsocket(async (d) => {
		  const events = Event.deserialize_list(await d.arrayBuffer());
		  events.forEach((event) => drawingModuleInstance.HandleEvent(event));
	  });

		const drawingModuleInstance = new DrawingModule("Canva");
		if (window.location.pathname == "/draw") {
			drawingModuleInstance.listen(sendMessage);
		}

		const map = new Map("map");
	</script>

</body>

</html>
